from openai import OpenAI

CLIENT = OpenAI(api_key="sk-proj-mmRKHjeDcfL9vQxDezi4T3BlbkFJKXL7oAEiuxFsU8ZC9xVs")

PROMPT = ("–ü–µ—Ä–µ—Ñ—Ä–∞–∑—É–π –æ—Å—Ç–∞–Ω–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞–ø–æ–≤–Ω—é—é—á–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ñ –ø—Ä–æ–±—ñ–ª–∏.\n"
          "–ü—Ä–∏–∫–ª–∞–¥ 1:\n"
          "–í—Ö—ñ–¥–Ω–∞ —Ä–æ–∑–º–æ–≤–∞:\n"
          "user: –ù–∞ —è–∫—ñ–π –≤—É–ª–∏—Ü—ñ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –í–ü–£‚Ññ29\n"
          "assistant: –ù–∞ –≤—É–ª–∏—Ü—ñ –®–µ–≤—á–µ–Ω–∫–∞ 112\n"
          "user: –•—Ç–æ –∑–∞—Ä–∞–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä —Ü—å–æ–≥–æ –í–ü–£?\n"
          "–†–µ–∑—É–ª—å—Ç–∞—Ç:\n"
          "–•—Ç–æ –∑–∞—Ä–∞–∑ —î –¥–∏—Ä–µ–∫—Ç–æ—Ä –í–ü–£‚Ññ29?\n"
        "–ü—Ä–∏–∫–ª–∞–¥ 2:\n"
          "–í—Ö—ñ–¥–Ω–∞ —Ä–æ–∑–º–æ–≤–∞:\n"
          "user: –•–æ—á—É –∫—É–ø–∏—Ç–∏ –∫—Ä—É–∞—Å–∞\n"
          "assistant: –ö—Ä—É—Ç–æ, —è–∫—ñ –∫—Ä—É–∞—Å–∞–Ω–∏ —Ç–µ–±–µ —Ü—ñ–∫–∞–≤–ª—è—Ç—å?\n"
          "user: —Ö–æ—á—É –∞–º—Å—Ç–µ—Ä–¥–∞–º\n"
          "–†–µ–∑—É–ª—å—Ç–∞—Ç:\n"
          "–•–æ—á—É –ø—Ä–∏–¥–±–∞—Ç–∏ –∫—Ä—É–∞—Å–∞–Ω –∞–º—Å—Ç–µ—Ä–¥–∞–º\n"
          "–ü—Ä–∏–∫–ª–∞–¥ 3:\n"


        )

chat_history = [
    {
        'role': 'system',
        'content': '–¢–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç –í–∏—â–æ–≥–æ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ–≥–æ —É—á–∏–ª–∏—â–∞ ‚Ññ29 –º.–õ—å–≤–æ–≤–∞, —è–∫–∏–π –¥–æ–ø–æ–º–∞–≥–∞—î —É—á–Ω—è–º –∞–±–æ –≤—Å—Ç—É–ø–Ω–∏–∫–∞–º'
                   '–î—ñ–∑–Ω–∞—Ç–∏—Å—è –Ω–æ–≤–∏–Ω–∏ —É—á–∏–ª–∏—â–∞, –≤—Å—Ç—É–ø–∏—Ç–∏ –¥–æ —É—á–∏–ª–∏—â–∞, –ø—Ä–æ—Ñ–µ—Å—ñ—ó —è–∫—ñ –º–æ–∂–Ω–∞ –∑–¥–æ–±—É—Ç–∏ –≤ —É—á–∏–ª–∏—â—ñ, –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —è–∫—ñ'
                   '–ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –¥–æ –≤—Å—Ç—É–ø—É, –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–π–æ–º—É, —ñ—Å—Ç–æ—Ä—ñ—è —É—á–∏–ª–∏—â–∞, –ù–ü–¶ –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –ù–ü–¶ –ü–µ—Ä—É–∫–∞—Ä—Å—å–∫–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ'
                   '–ù–ü–¶ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏—Ö —Ç–∞ —Ü–∏—Ñ—Ä–æ–≤–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π, —Ç–∞–∫–æ–∂ –∫–æ–ª–∏ –±—É–¥–µ—à –ø—Ä–æ—Å–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞–¥–∞—Ç–∏ —è–∫—ñ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç–∏'
                   '–∑–∞–≤–∂–¥–∏ –ø—Ä–æ—Å–∏ —ó—Ö –∑–∞–ª–∏—Ç–∏ –Ω–∞ imgur —Ç–∞ –Ω–∞–¥–∞—Ç–∏ —Ç–æ–±—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑ —Ü—å–æ–≥–æ —Å–∞–π—Ç—É. –ë—É–¥—å –¥–æ–±—Ä–æ—é —Ç–∞ –≤–µ—Å–µ–ª–æ—é, –∑–∞–≤–∂–¥–∏ –∂–∞—Ä—Ç—É–π. –¢–∏ —Å–æ–≤–∞ —ñ —Ç–≤–æ—î —ñ–º\'—è'
                   '–ê–º–∞–ª—ñ—è. –¢–≤–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –¥–æ 70 —Å–ª—ñ–≤'
    },
    {
        'role': 'user',
        'content': '–Ø–∫—ñ —î –ø—Ä–æ—Ñ–µ—Å—ñ—ó —É –í–ü–£‚Ññ29'
    },
    {
        'role': 'assistant',
        'content': 'üñã¬´–°–ª—é—Å–∞—Ä –∑ —Ä–µ–º–æ–Ω—Ç—É –∫–æ–ª—ñ—Å–Ω–∏—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤, –ï–ª–µ–∫—Ç—Ä–æ–∑–≤–∞—Ä–Ω–∏–∫ —Ä—É—á–Ω–æ–≥–æ –∑–≤–∞—Ä—é–≤–∞–Ω–Ω—è, \n'
          '–í–æ–¥—ñ–π –∞–≤—Ç–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤ (–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó ¬´–í¬ª, ¬´–°¬ª)¬ª üñã¬´–°–ª—é—Å–∞—Ä –∑ —Ä–µ–º–æ–Ω—Ç—É –∫–æ–ª—ñ—Å–Ω–∏—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤¬ª \n'
          'üñã¬´–û–ø–µ—Ä–∞—Ç–æ—Ä –∑ –æ–±—Ä–æ–±–∫–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è¬ª \n'
          'üñã¬´–ö—É—Ö–∞—Ä, –û—Ñ—ñ—Ü—ñ–∞–Ω—Ç¬ª üñã¬´–ö—É—Ö–∞—Ä, –ö–æ–Ω–¥–∏—Ç–µ—Ä¬ª üñã¬´–ö—É—Ö–∞—Ä, –ë–∞—Ä–º–µ–Ω¬ª üñã¬´–ü–µ—Ä—É–∫–∞—Ä (–ø–µ—Ä—É–∫–∞—Ä-–º–æ–¥–µ–ª—å—î—Ä), –ú–∞–Ω—ñ–∫—é—Ä–Ω–∏–∫¬ª üñã¬´–ü–µ—Ä—É–∫–∞—Ä (–ø–µ—Ä—É–∫–∞—Ä-–º–æ–¥–µ–ª—å—î—Ä), \n'
          '–í—ñ–∑–∞–∂–∏—Å—Ç¬ª üñã¬´–ü–µ—Ä—É–∫–∞—Ä (–ø–µ—Ä—É–∫–∞—Ä-–º–æ–¥–µ–ª—å—î—Ä)¬ª üñã¬´–ú–∞–π—Å—Ç–µ—Ä –∑ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Ç–∞ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ —É—Å—Ç–∞—Ç–∫—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤¬ª'
    },
    {
        'role': 'user',
        'content': '–†–æ–∑–∫–∞–∂–∏ –±—ñ–ª—å—à–µ –ø—Ä–æ 3 —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ—Å—Ç—å'
    },
]





def get_context_message(chat_history):
    prompt = PROMPT
    for message in chat_history:
        if message['role'] == 'system':
            continue
        else:
            prompt += f"{message['role']}: {message['content']}\n"

    prompt += "–†–µ–∑—É–ª—å—Ç–∞—Ç:"
    response = CLIENT.chat.completions.create(
        model="gpt-3.5-turbo",
        messages=[{
            'role': 'system',
            'content': prompt
        }])
    print(response.choices[-1].message.content)
    return response.choices[-1].message.content
